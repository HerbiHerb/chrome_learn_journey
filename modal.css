/* ============================
   Task Tree Modal – Komplett CSS
   (kompatibel mit deinem content.js Markup)
   ============================ */

/* Grund-Reset innerhalb des Modals */
#task-tree-modal, 
#task-tree-modal * { box-sizing: border-box; }

/* ----------------------------
   Overlay & Modal-Container
   ---------------------------- */
.task-modal-overlay {
  position: fixed;
  inset: 0;
  z-index: 2147483647; /* ganz oben */
  background: rgba(17, 24, 39, 0.55);
  display: none;             /* via .show sichtbar */
  align-items: center;
  justify-content: center;
  padding: 24px;
}

.task-modal-overlay.show { display: flex; }

.task-modal-content {
  width: min(1100px, 92vw);
  max-height: 92vh;
  background: #0f172a;       /* slate-900 */
  color: #e5e7eb;            /* gray-200 */
  border-radius: 12px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.35);
  display: flex;
  flex-direction: column;
  overflow: hidden;          /* Header/Footer fix, Body scroll-fähig */
  border: 1px solid rgba(148,163,184,0.25);
}

/* ----------------------------
   Header / Footer
   ---------------------------- */
.task-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 14px;
  border-bottom: 1px solid rgba(148,163,184,0.25);
  background: rgba(2,6,23,0.5); /* slate-950/50 */
}

.task-modal-header h2 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.task-modal-close {
  appearance: none;
  background: transparent;
  border: 0;
  color: #e5e7eb;
  font-size: 22px;
  line-height: 1;
  padding: 2px 8px;
  border-radius: 8px;
  cursor: pointer;
}
.task-modal-close:hover { background: rgba(148,163,184,0.18); }

.header-controls {
  display: flex;
  align-items: center;
  gap: 8px;
}

.task-modal-body {
  flex: 1 1 auto;
  min-height: 0;   /* wichtig: damit Kinder scrollen dürfen */
  overflow: hidden;/* Scrollen steuern wir in den Spalten */
  padding: 12px;
}

.task-modal-footer {
  padding: 8px 12px;
  border-top: 1px solid rgba(148,163,184,0.25);
  background: rgba(2,6,23,0.5);
  flex: 0 0 auto;
}

/* ----------------------------
   Hauptlayout im Body
   Markup:
   .task-layout-container
     ├─ .tree-selector-panel        (links)
     └─ .task-main-container        (mitte+rechts)
         ├─ .task-cytoscape-container (mitte)
         └─ .task-control-panel       (rechts)
   ---------------------------- */
.task-layout-container {
  height: 100%;
  min-height: 0;
  display: grid;
  grid-template-columns: 240px 1fr; /* zwei Spalten: links | main */
  gap: 12px;
}

/* Linke Spalte: gespeicherte Bäume */
.tree-selector-panel {
  background: rgba(30,41,59,0.35);  /* slate-800/35 */
  border: 1px solid rgba(148,163,184,0.25);
  border-radius: 10px;
  padding: 10px;
  overflow-y: auto;    /* eigene Scrollbar */
  min-width: 0;
}

/* Der Main-Container enthält Mitte + rechts */
.task-main-container {
  min-width: 0;
  min-height: 0;
  display: grid;
  grid-template-columns: 1fr minmax(320px, 380px); /* Mitte | Rechts */
  gap: 12px;
  height: 100%;
}

/* ----------------------------
   Mitte: Cytoscape
   ---------------------------- */
.task-cytoscape-container {
  position: relative;
  min-width: 0;
  min-height: 0;   /* damit #cy voll füllen kann */
  overflow: hidden;
  background: rgba(15,23,42,0.5);
  border: 1px solid rgba(148,163,184,0.25);
  border-radius: 10px;
}

/* Cytoscape-Canvas füllt den Container absolut */
#task-tree-modal #cy,
#task-tree-modal #task-cy {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

/* ----------------------------
   Rechte Spalte: Control Panel
   ---------------------------- */
.task-control-panel {
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-width: 0;
  overflow-y: auto; /* <— eigene Scrollbar, damit nichts abgeschnitten wird */
  background: transparent;
}

/* Abschnittsboxen rechts */
.task-control-panel .panel-section {
  background: rgba(30,41,59,0.35);
  border: 1px solid rgba(148,163,184,0.25);
  border-radius: 10px;
  padding: 10px;
  flex: 0 0 auto;  /* jedes Panel hat eigene Höhe; Spalte scrollt */
}

.panel-section h3 {
  margin: 0 0 8px 0;
  font-size: 14px;
  font-weight: 600;
}

/* Node-Info Bereich */
.node-info .no-selection {
  color: #94a3b8;
}
.node-title {
  font-weight: 600;
  margin-bottom: 6px;
}
.node-description {
  font-size: 13px;
  color: #cbd5e1;
  margin-bottom: 8px;
}
.node-status {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 12px;
  margin-top: 2px;
}
.status-pending { background: #334155; color: #e2e8f0; }
.status-in-progress { background: #065f46; color: #ecfdf5; }

/* ----------------------------
   Formulare / Buttons
   ---------------------------- */
.form-group { margin-bottom: 10px; }
.form-group label {
  display: block;
  font-size: 13px;
  margin-bottom: 6px;
  color: #e5e7eb;
}

.task-control-panel input,
.task-control-panel textarea,
.task-control-panel select {
  display: block;
  width: 100%;
  max-width: 100%;
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid rgba(148,163,184,0.35);
  background: rgba(2,6,23,0.35);
  color: #e5e7eb;
  outline: none;
}

.task-control-panel textarea {
  min-height: 80px;
  resize: vertical;
}

/* Buttons */
.task-btn {
  appearance: none;
  border: 1px solid rgba(148,163,184,0.35);
  background: rgba(2,6,23,0.5);
  color: #e5e7eb;
  border-radius: 8px;
  padding: 8px 12px;
  font-size: 13px;
  cursor: pointer;
}
.task-btn:hover { background: rgba(148,163,184,0.15); }

.task-btn-sm { padding: 6px 10px; font-size: 12px; border-radius: 7px; }
.task-btn-primary { background: #2563eb; border-color: #2563eb; color: #fff; }
.task-btn-primary:hover { background: #1d4ed8; }
.task-btn-secondary { background: #475569; border-color: #475569; color: #fff; }
.task-btn-secondary:hover { background: #374151; }
.task-btn-outline { background: transparent; }
.task-btn-success { background: #10b981; border-color: #10b981; color: #052e25; }
.task-btn-success:hover { background: #059669; color: #e7fff8; }

/* Error/Toast */
.error-message {
  color: #fecaca;
  background: rgba(127,29,29,0.25);
  border: 1px solid rgba(254,202,202,0.25);
  border-radius: 8px;
  padding: 8px 10px;
  font-size: 13px;
}

/* ----------------------------
   Linke Liste: Items
   ---------------------------- */
.panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 8px;
}
.panel-header h3 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
}

.tree-list { display: flex; flex-direction: column; gap: 8px; }
.empty-tree-list {
  color: #94a3b8;
  font-size: 13px;
  text-align: left;
}
.tree-item {
  border: 1px solid rgba(148,163,184,0.25);
  background: rgba(2,6,23,0.35);
  border-radius: 8px;
}
.tree-item-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 8px 10px;
  border-bottom: 1px solid rgba(148,163,184,0.18);
}
.tree-item-name { font-weight: 600; }
.tree-item .task-btn { margin: 8px 10px; }

/* ----------------------------
   Footer-Stats
   ---------------------------- */
.stats-panel {
  display: flex;
  align-items: center;
  gap: 16px;
  font-size: 12px;
  color: #cbd5e1;
}
.stat-item { display: flex; align-items: baseline; gap: 6px; }
.stat-value { font-weight: 700; }
.stat-label { color: #94a3b8; }

/* ----------------------------
   Typografie & Kleinkram
   ---------------------------- */
a { color: #93c5fd; }
a:hover { text-decoration: underline; }

#task-tree-modal .task-control-panel .node-info { overflow-wrap: anywhere; }

/* ----------------------------
   Responsive Verhalten
   ---------------------------- */
@media (max-width: 1024px) {
  .task-modal-content { width: min(960px, 96vw); }
  .task-main-container { grid-template-columns: 1fr minmax(300px, 340px); }
  .task-layout-container { grid-template-columns: 200px 1fr; }
}

@media (max-width: 860px) {
  /* Linke Spalte einklappen: alles untereinander */
  .task-layout-container { grid-template-columns: 1fr; }
  .tree-selector-panel { order: 2; height: 160px; }
  .task-main-container { grid-template-columns: 1fr; }
  .task-control-panel { max-height: 40vh; }
}

@media (max-height: 640px) {
  .task-modal-content { max-height: 96vh; }
}
